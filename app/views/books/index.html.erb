<p id="notice"><%= notice %></p>

<h1>Books</h1>

<h3>Filters</h3>

<%= form_with(url: filter_books_path, method: "get", :data => {:remote => false}) do %>
  <%= label_tag(:book_title, "Title:") %>
  <%= text_field_tag(:book_title) %>
  <%= label_tag(:book_author, "Author:") %>
  <%= text_field_tag(:book_author) %>
  <%= hidden_field_tag(:library_id, value = params[:library_id]) %>
  <br><br>
  <%= submit_tag("Search") %>
<% end %>

<table>
  <thead>
  <tr>
    <th>Isbn</th>
    <th>Title</th>
    <th>Author</th>
    <th>Language</th>
    <th>Published</th>
    <th>Edition</th>
    <th>Image</th>
    <th>Subject</th>
    <th>Summary</th>
    <th>Is special</th>
    <th colspan="3"></th>
  </tr>
  </thead>

  <tbody>
  <% @books.each do |book| %>
    <tr>
      <td><%= book.isbn %></td>
      <td><%= book.title %></td>
      <td><%= book.author %></td>
      <td><%= book.language %></td>
      <td><%= book.published %></td>
      <td><%= book.edition %></td>
      <td><%= book.image %></td>
      <td><%= book.subject %></td>
      <td><%= book.summary %></td>
      <td><%= book.is_special %></td>
      <td><%= link_to 'Show', book %></td>
      <% if session[:user_type] == ApplicationController::TYPE_ADMIN or session[:user_type] == ApplicationController::TYPE_LIBRARIAN %>
        <td><%= link_to 'Edit', edit_book_path(book) %></td>
        <td><%= link_to 'Destroy', book, method: :delete, data: {confirm: 'Are you sure?'} %></td>
      <% else %>
        <td><%= link_to 'Issue book', new_book_request_url(:request_type => BookRequest::IS_NORMAL, :book_id => book.id, :library_id => params[:library_id]) %></td>
        <td><%= link_to 'Bookmark book', new_book_request_url(:request_type => BookRequest::IS_BOOKMARK, :book_id => book.id, :library_id => params[:library_id]) %></td>
      <% end %>
    </tr>
  <% end %>
  </tbody>
</table>

<br>

<% if session[:user_type] == ApplicationController::TYPE_ADMIN or session[:user_type] == ApplicationController::TYPE_LIBRARIAN %>
  <%= link_to 'New Book', new_book_path %>
<% end %>
